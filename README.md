# Gemini PR Reviewer

![CI](https://github.com/igorschechtel/gemini-pr-reviewer/actions/workflows/ci.yml/badge.svg)
![Version](https://img.shields.io/github/v/tag/igorschechtel/gemini-pr-reviewer?label=version)
![Bun](https://img.shields.io/badge/Bun-%23000000.svg?style=flat&logo=bun&logoColor=white)
![Gemini](https://img.shields.io/badge/Powered%20by-Gemini-4285F4.svg?style=flat&logo=googlegemini&logoColor=white)
![License](https://img.shields.io/github/license/igorschechtel/gemini-pr-reviewer)

A fast, configurable GitHub Action that reviews pull requests with **Google Gemini**. It posts inline comments and a concise summary, helping you catch bugs, security issues, and performance bottlenecks before they merge.

<br />

## üöÄ Quick Start

### 1. Get a Gemini API Key
Obtain your API key from [Google AI Studio](https://aistudio.google.com/api-keys) and add it as a [repository secret](https://docs.github.com/en/actions/security-guides/using-secrets-in-github-actions) named `GEMINI_API_KEY`.

### 2. Add the Workflow
Create a file at `.github/workflows/gemini-review.yml`:

```yaml
name: Gemini PR Review

on:
  issue_comment:
    types: [created]

permissions:
  contents: read
  pull-requests: write
  issues: write

jobs:
  gemini-review:
    if: |
      github.event.issue.pull_request &&
      contains(github.event.comment.body, '/gemini-review')
    runs-on: ubuntu-latest
    steps:
      - name: Run Gemini PR Reviewer
        uses: igorschechtel/gemini-pr-reviewer@v0.1.0
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          GEMINI_MODEL: gemini-flash-latest
          REVIEW_MODE: standard
          REVIEW_INSTRUCTIONS: "Focus on correctness and security. Keep feedback concise."
          EXCLUDE: "dist/**,*.md,*.json"
```

### 3. Usage
Open a Pull Request and comment:
```text
/gemini-review
```

<br />

## üåü Features

- **Comment Trigger**: Initiate reviews with `/gemini-review` on any PR.
- **Two-Pass Review**:
    - **Global Context**: Analyzes the PR description and diff summary first.
    - **Inline Comments**: Provides specific, line-by-line feedback based on the global context.
- **Smart Filtering**: focus reviews using `INCLUDE` and `EXCLUDE` glob patterns.
- **Configurable Modes**: Choose from `strict`, `standard`, `security`, `performance`, or `lenient`.
- **Custom Instructions**: Add your own prompt instructions (e.g., "Focus on TypeScript best practices").
- **Safety Limits**: Built-in caps for files, hunks, and lines to prevent API overuse.

<br />

## ‚öôÔ∏è Configuration

### Inputs

| Input | Required | Default | Description |
| :--- | :---: | :--- | :--- |
| `GITHUB_TOKEN` | ‚úÖ | - | GitHub token to read PR data and post reviews (auto-generated by GitHub). |
| `GEMINI_API_KEY` | ‚úÖ | - | Google Gemini API key. |
| `GEMINI_MODEL` | ‚ùå | `gemini-flash-latest` | Gemini model to use. See [available models](https://ai.google.dev/gemini-api/docs/models). |
| `REVIEW_MODE` | ‚ùå | `standard` | Review strictness/focus (see below). |
| `REVIEW_INSTRUCTIONS` | ‚ùå | `""` | Custom instructions appended to the system prompt. |
| `COMMAND_TRIGGER` | ‚ùå | `/gemini-review` | Comment text that triggers the action. |
| `EXCLUDE` | ‚ùå | `""` | Glob patterns to exclude (e.g., `**/*.test.ts`). |
| `INCLUDE` | ‚ùå | `""` | Glob patterns to include (overrides exclude). |
| `GLOBAL_REVIEW` | ‚ùå | `true` | Enable the initial global context pass. |

### Review Modes

| Mode | Focus |
| :--- | :--- |
| `standard` | General bugs, security, performance, and maintainability. Skips minor style nits. |
| `strict` | Pedantic review. Includes minor style issues, variable naming, and best practices. |
| `lenient` | Only critical bugs and major security vulnerabilities. |
| `security` | **Security focus only**. Looks for OWASP Top 10, secrets, and vulnerabilities. |
| `performance` | **Performance focus only**. Looks for N+1 queries, memory leaks, and inefficiencies. |

<br />

## üíª Local Development

If you want to contribute or run the reviewer locally:

1.  **Clone & Install**
    ```bash
    git clone https://github.com/igorschechtel/gemini-pr-reviewer.git
    cd gemini-pr-reviewer
    bun install
    ```

2.  **Run Tests**
    ```bash
    bun test
    ```

3.  **Full Check (Lint + Type + Test)**
    ```bash
    bun run check
    ```

4.  **Local E2E Simulation**
    Create a `.env` file with `GEMINI_API_KEY` and `GITHUB_TOKEN`, then run:
    ```bash
    bun run scripts/local_e2e.ts
    ```

<br />

## üõ£Ô∏è Roadmap

Planned improvements and milestones are tracked in [ROADMAP.md](ROADMAP.md).

<br />

## üìÑ License

MIT License. See [LICENSE.md](LICENSE.md).

<br />

---
*Note for AI Agents: Please refer to [AGENTS.md](./AGENTS.md) for project-specific conventions and instructions.*
